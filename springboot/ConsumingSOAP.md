---
layout: springboot
permalink: /springboot/ConsumingSOAP/
---
## SOAP
SOAP (Simple Object Access Protocol) is an XML-based protocol for accessing web services over HTTP. There are a huge number of applications which are built on different programming languages - XML is used as the intermediate language for exchanging data between applications. Every programming language can understand the XML markup language. But there are no standard specifications on use of XML across all programming languages for data exchange - that is where SOAP comes in. SOAP was designed to work with XML over HTTP and have some sort of specification which could be used across all applications.

The SOAP specification defines something known as a "SOAP message" which is what is sent to the web service and the client application. 

<img src="/assets/img/soap.png" alt="soap message" align="left">

**SOAP Envelope**: Envelope is the root element in every SOAP message, and contains two child elements, an optional Header element, and a mandatory Body element. ***The SOAP envelope element is used to indicate the beginning and end of a SOAP message***. This enables the client application which calls the web service to know when the SOAP message ends. <br>
**SOAP Header**: Header is an optional subelement of the SOAP envelope. If an Envelope element contains a header element, it must contain no more than one, and it must appear as the first child of the Envelope, before the body element. ***The header element can contain information such as authentication credentials which can be used by the calling application***. It can also contain the definition of complex types which could be used in the SOAP message. <br>
**SOAP Body**: Body is a mandatory subelement of the SOAP envelope, which contains information intended for the ultimate recipient of the message. ***This element is what contains the actual data which needs to be sent between the web service and the calling application.*** <br>

**SOAP Fault**: When a request is made to a SOAP web service, the response returned can be a success or an error. When a success is generated, the response from the server will always be a SOAP message. But if SOAP faults are generated, they are returned as "HTTP 500" errors. The SOAP Fault message will contain details about the fault code, fault string (text message which gives a detailed description of the error) etc. <br>

One thing to note is that SOAP messages are normally auto-generated by the web service when it is called. Whenever a client application calls a method in the web service, the web service will automatically generate a SOAP message which will have the necessary details of the data which will be sent from the web service to the client application.

The following code is an example of a SOAP message that contains header blocks (the m:reservation and n:passenger elements) and a body (containing the p:itinterary element):

```xml
<?xml version='1.0' Encoding='UTF-8' ?>
<env:Envelope xmlns:env="http://www.w3.org/2003/05/soap-envelope"> 
 <env:Header>
  <m:reservation xmlns:m="http://travelcompany.example.org/reservation" 
		env:role="http://www.w3.org/2003/05/soap-envelope/role/next">
   <m:reference>uuid:093a2da1-q345-739r-ba5d-pqff98fe8j7d</m:reference>
   <m:dateAndTime>2007-11-29T13:20:00.000-05:00</m:dateAndTime>
  </m:reservation>
  <n:passenger xmlns:n="http://mycompany.example.com/employees" 
		env:role="http://www.w3.org/2003/05/soap-envelope/role/next">
   <n:name>Fred Bloggs</n:name>
  </n:passenger>
 </env:Header>
 <env:Body>
  <p:itinerary xmlns:p="http://travelcompany.example.org/reservation/travel">
   <p:departure>
     <p:departing>New York</p:departing>
     <p:arriving>Los Angeles</p:arriving>
     <p:departureDate>2007-12-14</p:departureDate>
     <p:departureTime>late afternoon</p:departureTime>
     <p:seatPreference>aisle</p:seatPreference>
   </p:departure>
   <p:return>
     <p:departing>Los Angeles</p:departing>
     <p:arriving>New York</p:arriving>
     <p:departureDate>2007-12-20</p:departureDate>
     <p:departureTime>mid-morning</p:departureTime>
     <p:seatPreference></p:seatPreference>
   </p:return>
  </p:itinerary>
 </env:Body>
</env:Envelope>
```
<br>

## Consuming SOAP: Spring Web Services

Spring Web Services makes consumption of SOAP-based web service process easy by automatically generating the files you need in order to consume a SOAP-based web service.  In order to generate the files, the WSDL for the SOAP service in question is needed. ***WSDL stands for Web Services Description Language and simply describes the web service: its location and the operations allowed***.

In our example, we will consume the below SOAP service - it takes a number and returns the word form of that number.

SOAP Service: https://www.dataaccess.com/webservicesserver/numberconversion.wso 

For example, if I provide 2931, the response will be in an XML format:

```xml
<string>
	two thousand nine hundred and thirty one
</string>
```
<br>

**Step 1: Add Dependencies in pom.xml**

Add the below dependency in pom.xml

```xml
<dependency>
	<groupId>org.springframework.boot</groupId>
	<artifactId>spring-boot-starter-web-services</artifactId>
</dependency>
```
<br>

Add the below plugin:

```xml
<plugin>
	<groupId>org.jvnet.jaxb2.maven2</groupId>
	<artifactId>maven-jaxb2-plugin</artifactId>
	<version>0.14.0</version>
	<executions>
		<execution>
			<goals>
				<goal>generate</goal>
			</goals>
		</execution>
	</executions>
	<configuration>
		<schemaDirectory>${project.basedir}/src/main/resources/wsdl</schemaDirectory>
			<schemaIncludes>
			<include>*.wsdl</include>
		</schemaIncludes>
	</configuration>
</plugin>
```



